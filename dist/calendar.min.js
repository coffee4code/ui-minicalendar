angular.module("ui.minicalendar",[]).provider("uiMiniCalendar",[function(){function a(){return d}function b(){return arguments.length?"string"==typeof arguments[0]?(d[arguments[0]]=arguments[1],!0):(d=angular.extend(d,arguments[0],{},!0),!0):!1}var c=new Date,d={year:c.getFullYear(),month:c.getMonth()+1,date:c.getDate(),minDate:null,maxDate:null,daysHasEvents:["2015-12-03","2015-12-08"],showTodayBtn:!0,todayText:"Today",weekText:["Sun","Mon","Tue","Wen","Thr","Fri","Sat"],monthText:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],onCellClick:function(a,b,c,d,e,f){console.info([a,b,c,d,e,f].join("/"))},onPrevMonth:function(a,b){console.info([a,b].join("*"))},onNextMonth:function(a,b){console.info([a,b].join("*"))}};this.$get=function(){return{getOptions:a}},this.setOptions=b}]).directive("uiMiniCalendar",["uiMiniCalendar",function(a){return{restrict:"E",scope:{calOptions:"="},templateUrl:function(){return"__ui_minicalendar.html"},replace:!0,controller:["$scope","$element","$attrs",function(b,c,d){b.today=new Date,b.disableButtonNext=!1,b.disableButtonPrev=!1,b.calOptions=angular.extend(a.getOptions(),b.calOptions),b.calOptions.currentActiveDateStr=[b.calOptions.year,String(b.calOptions.month).replace(/^([\d])$/,"0$1"),String(b.calOptions.date).replace(/^([\d])$/,"0$1")].join("-")}],link:function(a,b,c){function d(b){a.datesRow=j(Number(b.year),Number(b.month)),a.disableButtonPrev=i(-1),a.disableButtonNext=i(1)}function e(){return l(a.calOptions.year,Number(a.calOptions.month),1)?(a.calOptions.year=Number(a.calOptions.year),a.calOptions.month=Number(a.calOptions.month),12==a.calOptions.month?(a.calOptions.month=1)&&a.calOptions.year++:a.calOptions.month++,void(a.calOptions.onNextMonth&&"function"==typeof a.calOptions.onNextMonth&&a.calOptions.onNextMonth(a.calOptions.year,a.calOptions.month))):!1}function f(){return k(a.calOptions.year,Number(a.calOptions.month)-1,1)?(a.calOptions.year=Number(a.calOptions.year),a.calOptions.month=Number(a.calOptions.month),1==a.calOptions.month?(a.calOptions.month=12)&&a.calOptions.year--:a.calOptions.month--,void(a.calOptions.onPrevMonth&&"function"==typeof a.calOptions.onPrevMonth&&a.calOptions.onPrevMonth(a.calOptions.year,a.calOptions.month))):!1}function g(b){b&&b.isFill&&(a.calOptions.currentActiveDateStr=b.dateStr),a.calOptions.onCellClick&&"function"==typeof a.calOptions.onCellClick&&b&&a.calOptions.onCellClick(a.calOptions.year,a.calOptions.month,b.dateToDisplay,b.hasEvent,b.isFill,b.isToday)}function h(){a.calOptions.year=a.today.getFullYear(),a.calOptions.month=a.today.getMonth()+1,a.calOptions.date=a.today.getDate(),a.calOptions.currentActiveDateStr=a.cellToday.dateStr,a.calOptions.onCellClick&&"function"==typeof a.calOptions.onCellClick&&a.calOptions.onCellClick(a.calOptions.year,a.calOptions.month,a.cellToday.dateToDisplay,a.cellToday.hasEvent,a.cellToday.isFill,a.cellToday.isToday)}function i(b){var c,d;return c=Number(a.calOptions.year),d=Number(a.calOptions.month),b>0?!l(c,d,1):!k(c,d-1,1)}function j(b,c){c-=1;for(var d=new Date(b,c,1),e=[[],[],[],[],[],[]],f=d.getDay(),g=0;f>g;)e[0].push(null),f--;for(;d.getMonth()===c;){7==e[g].length&&g++;var h=new Date(d),i=h.getFullYear(),j=h.getMonth(),n=h.getDate(),o=k(i,j,n+1)&&l(i,j,n),p=i==a.today.getFullYear()&&j==a.today.getMonth()&&n==a.today.getDate(),q=a.calOptions.daysHasEvents&&a.calOptions.daysHasEvents.length?a.calOptions.daysHasEvents.indexOf([i,m(j+1),m(n)].join("-"))>-1:!1,r={dateToDisplay:h.getDate(),dateStr:[b,m(c+1),m(h.getDate())].join("-"),isFill:o,isToday:p,hasEvent:q};p&&(a.cellToday=r),e[g].push(r),d.setDate(d.getDate()+1)}return e}function k(b,c,d){if(!a.calOptions.minDate)return!0;var e=new Date(b,c,d).getTime(),f=new Date(a.calOptions.minDate).getTime();return e>=f}function l(b,c,d){if(!a.calOptions.maxDate)return!0;var e=new Date(b,c,d).getTime(),f=new Date(a.calOptions.maxDate).getTime();return f>e}function m(a){return String(a).replace(/^([\d])$/,"0$1")}a.nextMonth=e,a.prevMonth=f,a.goToClickDay=g,a.goToToday=h,a.$watch("calOptions",function(a,b){d(a)},!0)}}}]).run(["$templateCache",function(a){a.put("__ui_minicalendar.html",'<div class="__ui_minicalendar_container"><div class="__ui_minicalendar_top"><div class="__ui_minicalendar_pull_left"><button class="__ui_minicalendar_icon" ng-disabled="disableButtonPrev" ng-class=" disableButtonPrev?\'__ui_minicalendar_disabled\':\'\' " ng-click="prevMonth();"><svg width="512" height="512" viewBox="0 0 512 512"><path d="m344 155c0 3-1 5-3 7l-112 112 112 113c2 1 3 4 3 6 0 3-1 5-3 7l-14 14c-2 2-5 3-7 3-2 0-5-1-7-3l-133-133c-2-2-3-4-3-7 0-2 1-4 3-6l133-133c2-2 5-3 7-3 2 0 5 1 7 3l14 14c2 2 3 4 3 6z"></path></svg></button></div><div><span ng-bind="calOptions.year"></span><span ng-repeat="($index,month) in calOptions.monthText" ng-if="$index+1==calOptions.month" ng-bind="month"></span><a ng-if="calOptions.showTodayBtn" ng-click="goToToday();" ng-bind="calOptions.todayText"></a></div><div class="__ui_minicalendar_pull_right"><button class="__ui_minicalendar_icon" ng-disabled="disableButtonNext" ng-class=" disableButtonNext?\'__ui_minicalendar_disabled\':\'\' " ng-click="nextMonth();"><svg width="512" height="512" viewBox="0 0 512 512"><path d="m335 274c0 3-1 5-3 7l-133 133c-2 2-5 3-7 3-2 0-5-1-7-3l-14-14c-2-2-3-4-3-7 0-2 1-5 3-6l112-113-112-112c-2-2-3-4-3-7 0-2 1-4 3-6l14-14c2-2 5-3 7-3 2 0 5 1 7 3l133 133c2 2 3 4 3 6z"></path></svg></button></div></div><div class="__ui_minicalendar_content"><table><thead><tr><td ng-repeat="week in calOptions.weekText" ng-bind="week"></td></tr></thead><tbody><tr ng-if="row.length" ng-repeat="row in datesRow track by $index">'+"<td ng-repeat=\"cell in row track by $index\" ng-click=\"goToClickDay(cell);\" ng-class=\" (cell.isFill?'__ui_minicalendar_cell_fill':'')+' '+(cell.isToday?'__ui_minicalendar_cell_today':'')+' '+(cell.hasEvent?'__ui_minicalendar_cell_has_event':'')+' '+(cell.dateStr==calOptions.currentActiveDateStr?'__ui_minicalendar_cell_active':'')\" ng-bind=\"cell.dateToDisplay\"></tr></tbody></table></div></div>")}]).filter("fillzero",[function(){return function(a){return String(a).replace(/^([\d])$/,"0$1")}}]).config(["uiMiniCalendarProvider",function(a){a.setOptions()}]);